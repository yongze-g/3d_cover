# 3D图书封面渲染器

> **重要声明**：本项目由AI生成，目前处于测试阶段，尚未正式发布。功能可能存在不完善之处，欢迎反馈问题和改进建议。

一个用于生成图书立体封面效果的工具，支持上传封面和书脊图片，通过调整参数实时预览并下载立体效果图片。

## 功能特点

- ✅ 支持上传封面和书脊图片
- ✅ 支持多书脊模式（单书脊视为长度为1的多书脊）
- ✅ 支持书脊阴影效果（线性阴影）
- ✅ 可调整相机与书距离、开本宽度、旋转角度等参数
- ✅ 支持书脊额外展开角度调节
- ✅ 支持相机高度比例调整，获得不同视角
- ✅ 自定义背景颜色和透明度设置
- ✅ 可调整输出图像尺寸和边框占比
- ✅ 实时预览渲染结果
- ✅ 下载生成的3D封面图片（支持透明背景PNG格式）

## 技术栈

- **编程语言**: Python 3.9+
- **图像处理**: OpenCV, NumPy, Pillow
- **Web界面**: Streamlit

## 安装指南

### 方法1: 使用Conda环境（推荐）

```bash
# 创建并激活conda环境
conda create -n 3d_cover python=3.9 -y
conda activate 3d_cover

# 安装依赖
pip install -r requirements.txt
```

### 方法2: 使用Python虚拟环境

```bash
# 创建虚拟环境
python -m venv venv

# 激活虚拟环境
# Windows
env\Scripts\activate
# macOS/Linux
# source venv/bin/activate

# 安装依赖
pip install -r requirements.txt
```

## 使用方法

1. 激活环境（如果尚未激活）
   ```bash
   # Conda环境
   conda activate 3d_cover
   # 或Python虚拟环境
   # Windows: env\Scripts\activate
   # macOS/Linux: source venv/bin/activate
   ```

2. 运行应用程序
   ```bash
   streamlit run app.py
   ```

3. 在浏览器中打开生成的URL（通常是 http://localhost:8501）

4. 按照界面提示上传图片并调整参数

## 参数说明

- **相机与书距离（mm）**: 控制3D效果的透视深度，距离越小效果越明显
- **开本宽度（mm）**: 控制书籍封面的宽度，影响渲染比例
- **旋转角度（°）**: 调整立体效果的旋转角度，范围1-89度
- **书脊额外展开角度**: 控制书脊额外展开的角度，当书脊太窄时可增加此值，最大可展至完全面向正面
- **书脊阴影模式**: 选择书脊阴影效果（无/线性）
- **相机相对高度比例**: 控制3D视角的垂直位置，0表示从底部视角，1表示从顶部视角，0.5为标准视角
- **背景颜色**: 设置渲染结果的背景色
- **背景不透明度**: 控制背景的透明程度（0表示完全透明，100表示完全不透明）
- **输出图像尺寸（像素）**: 控制最终生成图像的尺寸，影响图像质量和文件大小
- **边框占比**: 控制生成图像中边框的比例，范围0.0-0.2，在图像周围添加空白区域
- **书型选择**: 支持平装和精装书型（开发中）

## 示例

1. 上传封面图片（通常是书籍正面的设计图）
2. 上传书脊图片（包含书名、作者等信息）
   - 可以上传一个或多个书脊图片，系统会自动拼合（单书脊视为长度为1的多书脊）
3. 选择书脊阴影模式（推荐使用线性阴影以获得更真实的效果）
4. 调整相机参数和书籍参数以获得理想的透视效果
5. 设置背景颜色和透明度
6. 调整输出图像尺寸和边框占比
7. 点击"下载立体封"按钮保存结果

## 文件结构

```
3d_cover/
├── app.py            # 主应用程序入口文件
├── renderer.py       # 渲染器模块，处理3D封面生成核心逻辑
├── ui.py             # 用户界面模块，处理交互界面
├── processor.py      # 处理器模块，处理图片和结果展示
├── requirements.txt  # 项目依赖
├── shadows/          # 阴影图片资源文件夹
│   └── linear.png    # 线性阴影图片
├── test_resource/    # 测试资源文件夹
└── README.md         # 项目说明文档
```

## 系统要求

- Python 3.9或更高版本
- 支持的操作系统：Windows, macOS, Linux
- 推荐至少4GB RAM以处理较大的图片文件

## 注意事项

- 为获得最佳效果，请确保上传的封面和书脊图片具有相同的高度
- 支持的图片格式：PNG, JPG, JPEG
- 对于大型图片文件，处理时间可能会略有延长
- 当设置背景不透明度小于100时，下载的PNG图片将保留透明背景
- 系统会自动将多个书脊图片拼合，单书脊视为长度为1的多书脊
- 线性阴影模式可以为书脊添加更真实的阴影效果

## 开发和扩展

如果您想进一步开发或扩展此项目，以下是一些建议：

- 完善精装书型的渲染效果
- 添加书籍封底支持
- 实现批量处理功能
- 添加更多预设的渲染样式
- 优化大型图片的处理性能
- 添加更多阴影模式选项
- 实现保存和加载参数配置的功能

## 许可证

本项目采用MIT许可证。

## 联系方式

如有任何问题或建议，请随时提出。